{% extends "base.html" %}

{% block title %}Schedule Maintenance - BBSchedule Platform{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ url_for('equipment.equipment_list') }}">Equipment</a></li>
                    <li class="breadcrumb-item"><a href="{{ url_for('equipment.maintenance_schedule') }}">Maintenance</a></li>
                    <li class="breadcrumb-item active">Schedule</li>
                </ol>
            </nav>
            
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="h3 mb-0">Schedule Maintenance</h1>
                    <p class="text-muted mb-0">Create new maintenance activity for equipment</p>
                </div>
                <a href="{{ url_for('equipment.maintenance_schedule') }}" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-2"></i>Back to Schedule
                </a>
            </div>
        </div>
    </div>

    <!-- Maintenance Form -->
    <div class="row">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0">Maintenance Information</h6>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Feature Coming Soon!</strong> Maintenance scheduling functionality is being developed and will be available in the next update.
                    </div>
                    
                    <form method="POST">
                        <div class="row g-4">
                            <!-- Equipment Selection -->
                            <div class="col-md-6">
                                <label for="equipment_id" class="form-label">Equipment *</label>
                                <select class="form-select" id="equipment_id" name="equipment_id" required disabled>
                                    <option value="">Select equipment...</option>
                                    {% for equipment in equipment_list %}
                                    <option value="{{ equipment.id }}">{{ equipment.equipment_number }} - {{ equipment.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="maintenance_type" class="form-label">Maintenance Type *</label>
                                <select class="form-select" id="maintenance_type" name="maintenance_type" required disabled>
                                    <option value="">Select type...</option>
                                    {% for m_type in maintenance_types %}
                                    <option value="{{ m_type.value }}">{{ m_type.value.replace('_', ' ').title() }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <!-- Scheduling -->
                            <div class="col-md-6">
                                <label for="scheduled_date" class="form-label">Scheduled Date *</label>
                                <input type="date" class="form-control" id="scheduled_date" name="scheduled_date" required disabled>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="estimated_duration_hours" class="form-label">Estimated Duration</label>
                                <div class="input-group">
                                    <input type="number" class="form-control" id="estimated_duration_hours" name="estimated_duration_hours" step="0.5" min="0" disabled>
                                    <span class="input-group-text">hours</span>
                                </div>
                            </div>
                            
                            <!-- Assignment -->
                            <div class="col-md-6">
                                <label for="assigned_technician_id" class="form-label">Assigned Technician</label>
                                <select class="form-select" id="assigned_technician_id" name="assigned_technician_id" disabled>
                                    <option value="">Select technician...</option>
                                    {% for technician in technicians %}
                                    <option value="{{ technician.id }}">{{ technician.username }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="supplier_id" class="form-label">Service Provider</label>
                                <select class="form-select" id="supplier_id" name="supplier_id" disabled>
                                    <option value="">Internal maintenance</option>
                                    {% for supplier in suppliers %}
                                    <option value="{{ supplier.id }}">{{ supplier.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <!-- Description -->
                            <div class="col-12">
                                <label for="description" class="form-label">Description *</label>
                                <textarea class="form-control" id="description" name="description" rows="3" required disabled
                                          placeholder="Describe the maintenance work to be performed..."></textarea>
                            </div>
                            
                            <!-- Cost Estimates -->
                            <div class="col-12">
                                <h6 class="mt-3 mb-3">Cost Estimates</h6>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="estimated_labor_cost" class="form-label">Labor Cost</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control" id="estimated_labor_cost" name="estimated_labor_cost" step="0.01" min="0" disabled>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="estimated_parts_cost" class="form-label">Parts & Materials Cost</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control" id="estimated_parts_cost" name="estimated_parts_cost" step="0.01" min="0" disabled>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Form Actions -->
                        <div class="d-flex justify-content-end gap-2 mt-4 pt-4 border-top">
                            <a href="{{ url_for('equipment.maintenance_schedule') }}" class="btn btn-secondary">Cancel</a>
                            <button type="submit" class="btn btn-primary" disabled>
                                <i class="fas fa-calendar-plus me-2"></i>Schedule Maintenance
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Sidebar -->
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0">Maintenance Types</h6>
                </div>
                <div class="card-body">
                    <div class="maintenance-types">
                        <div class="type-item mb-3">
                            <h6 class="text-primary mb-1">
                                <i class="fas fa-calendar-check me-2"></i>Preventive
                            </h6>
                            <p class="small text-muted mb-0">Regular scheduled maintenance to prevent issues</p>
                        </div>
                        
                        <div class="type-item mb-3">
                            <h6 class="text-warning mb-1">
                                <i class="fas fa-tools me-2"></i>Corrective
                            </h6>
                            <p class="small text-muted mb-0">Repairs to fix known issues or problems</p>
                        </div>
                        
                        <div class="type-item mb-3">
                            <h6 class="text-danger mb-1">
                                <i class="fas fa-exclamation-triangle me-2"></i>Emergency
                            </h6>
                            <p class="small text-muted mb-0">Urgent repairs for critical equipment failures</p>
                        </div>
                        
                        <div class="type-item">
                            <h6 class="text-info mb-1">
                                <i class="fas fa-search me-2"></i>Inspection
                            </h6>
                            <p class="small text-muted mb-0">Safety and compliance inspections</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card mt-4">
                <div class="card-header">
                    <h6 class="mb-0">Scheduling Guidelines</h6>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled small mb-0">
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            Schedule maintenance during off-peak hours when possible
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            Allow adequate time for parts procurement
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            Coordinate with project schedules to minimize disruption
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            Assign qualified technicians based on maintenance type
                        </li>
                        <li>
                            <i class="fas fa-check text-success me-2"></i>
                            Include safety requirements and procedures
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="card mt-4">
                <div class="card-header">
                    <h6 class="mb-0">Quick Actions</h6>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <button class="btn btn-outline-primary btn-sm" onclick="importMaintenanceTemplate()" disabled>
                            <i class="fas fa-file-import me-2"></i>Import Template
                        </button>
                        <button class="btn btn-outline-secondary btn-sm" onclick="viewMaintenanceHistory()" disabled>
                            <i class="fas fa-history me-2"></i>View History
                        </button>
                        <button class="btn btn-outline-info btn-sm" onclick="checkAvailability()" disabled>
                            <i class="fas fa-calendar me-2"></i>Check Availability
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function importMaintenanceTemplate() {
    alert('Import template feature coming soon!');
}

function viewMaintenanceHistory() {
    alert('Maintenance history feature coming soon!');
}

function checkAvailability() {
    alert('Availability checker feature coming soon!');
}

// Auto-calculate total cost
document.addEventListener('DOMContentLoaded', function() {
    const laborCost = document.getElementById('estimated_labor_cost');
    const partsCost = document.getElementById('estimated_parts_cost');
    
    function calculateTotal() {
        const labor = parseFloat(laborCost.value) || 0;
        const parts = parseFloat(partsCost.value) || 0;
        const total = labor + parts;
        
        // Would update a total cost field if it existed
        console.log('Total estimated cost:', total);
    }
    
    laborCost.addEventListener('input', calculateTotal);
    partsCost.addEventListener('input', calculateTotal);
});
</script>

<style>
.type-item {
    padding: 0.75rem;
    background-color: #f8f9fa;
    border-left: 3px solid #007bff;
    border-radius: 0 4px 4px 0;
}

.type-item h6 {
    margin-bottom: 0.25rem;
}

.input-group-text {
    background-color: #f8f9fa;
    border-color: #dee2e6;
}

.form-control:disabled,
.form-select:disabled {
    background-color: #f8f9fa;
    opacity: 0.65;
}

.btn:disabled {
    opacity: 0.65;
}
</style>
{% endblock %}